{"ast":null,"code":"import { PERMIT_ACTIONS_CONFIG } from 'src/app/constants/db.constants';\nimport { DataHelper } from 'src/app/utility/data.helper';\nimport { WidgetComponentBase } from 'src/app/utility/widget/widget-utility/widget-component-base';\nimport { PermitImagesAndFilesDetailsModel } from './permit-images-and-files-tab.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/server-api-interface-service.service\";\nimport * as i2 from \"src/app/services/app-repo-helper.service\";\nimport * as i3 from \"src/app/services/save-file.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/platform-browser\";\nimport * as i6 from \"@angular/material/dialog\";\nimport * as i7 from \"src/app/services/validation.service\";\nimport * as i8 from \"src/app/services/app-repo.service\";\nimport * as i9 from \"@angular/flex-layout/flex\";\nimport * as i10 from \"@angular/common\";\nimport * as i11 from \"@angular/material/button\";\nimport * as i12 from \"@angular/material/icon\";\nimport * as i13 from \"@angular/material/tooltip\";\nimport * as i14 from \"../../../pipe/transform-date-time/transform-date-time.pipe\";\n\nfunction PermitImagesAndFilesTabComponent_button_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function PermitImagesAndFilesTabComponent_button_9_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return ctx_r2.openFileUpload();\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"publish\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \"Upload \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PermitImagesAndFilesTabComponent_div_11_div_1_img_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 21);\n  }\n\n  if (rf & 2) {\n    const i_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"src\", i_r5.imageSrc, i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction PermitImagesAndFilesTabComponent_div_11_div_1_mat_icon_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\", 22);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const i_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i_r5.iconName, \" \");\n  }\n}\n\nfunction PermitImagesAndFilesTabComponent_div_11_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵelementStart(1, \"div\", 13);\n    i0.ɵɵtemplate(2, PermitImagesAndFilesTabComponent_div_11_div_1_img_2_Template, 1, 1, \"img\", 14);\n    i0.ɵɵtemplate(3, PermitImagesAndFilesTabComponent_div_11_div_1_mat_icon_3_Template, 2, 1, \"mat-icon\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 16);\n    i0.ɵɵelementStart(5, \"div\", 17);\n    i0.ɵɵelementStart(6, \"h3\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"p\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"p\");\n    i0.ɵɵtext(13);\n    i0.ɵɵpipe(14, \"transformDateTime\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"div\", 18);\n    i0.ɵɵelementStart(16, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function PermitImagesAndFilesTabComponent_div_11_div_1_Template_button_click_16_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const i_r5 = restoredCtx.$implicit;\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return ctx_r10.getFileApiData(i_r5.fileId, i_r5.filename);\n    });\n    i0.ɵɵelementStart(17, \"mat-icon\", 20);\n    i0.ɵɵtext(18, \"get_app\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const i_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", i_r5.isImage);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !i_r5.isImage);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i_r5 == null ? null : i_r5.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Created By: \", i_r5 == null ? null : i_r5.createdBy, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Size: \", i_r5 == null ? null : i_r5.fileSize, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Created on: \", i0.ɵɵpipeBind1(14, 6, i_r5 == null ? null : i_r5.createDate), \"\");\n  }\n}\n\nfunction PermitImagesAndFilesTabComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵtemplate(1, PermitImagesAndFilesTabComponent_div_11_div_1_Template, 19, 8, \"div\", 11);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.dataModel.data);\n  }\n}\n\nexport let PermitImagesAndFilesTabComponent = /*#__PURE__*/(() => {\n  class PermitImagesAndFilesTabComponent extends WidgetComponentBase {\n    constructor(_serverApi, _appRepoHelperService, _saveFileService, _router, sanitizer, dialog, _validationService, _appRepoService) {\n      super(_serverApi, _validationService);\n      this._serverApi = _serverApi;\n      this._appRepoHelperService = _appRepoHelperService;\n      this._saveFileService = _saveFileService;\n      this._router = _router;\n      this.sanitizer = sanitizer;\n      this.dialog = dialog;\n      this._validationService = _validationService;\n      this._appRepoService = _appRepoService;\n      this.PERMIT_ACTIONS_CONFIG = PERMIT_ACTIONS_CONFIG;\n    }\n\n    ngOnInit() {\n      this.applicationId = this.dataModel.globalParameters.get('applicationId');\n      this.wgOnInit();\n    }\n\n    getControlData() {\n      //this.applicationId = this.dataModel.globalParameters.get('applicationId');\n      // INFO: ServerAPI\n      let url = `/api/v1/applications/${this.dataModel.globalParameters.get('applicationId')}/files`;\n      return this.wgAPIMethodGet(url);\n    }\n\n    convertData(response) {\n      let items = [];\n\n      if (response) {\n        response.forEach(element => {\n          let item = new PermitImagesAndFilesDetailsModel();\n          item.fileId = element.fileId;\n          item.workId = element.workId;\n          item.applicationId = element.applicationId;\n          item.fileRefId = element.fileRefId;\n          item.objectRefId = element.objectRefId;\n          item.filename = element.filename;\n          item.title = DataHelper.removeExtensionFromName(element.filename);\n          item.fileType = element.fileType;\n          item.fileLinked = element.fileLinked;\n          item.createdBy = element.createdBy;\n          item.createDate = element.createDate;\n          item.fileSize = DataHelper.FormatSize(element.fileSize);\n          item.extension = DataHelper.getFileExetension(element.filename);\n          item.isImage = DataHelper.isImage(item.extension);\n          item.iconName = item.isImage ? 'image' : 'text_snippet';\n\n          if (item.isImage) {\n            this.getImage(item.fileId).then(response => {\n              item.imageBlob = response;\n              let unsafeImageUrl = URL.createObjectURL(item.imageBlob);\n              item.imageSrc = this.sanitizer.bypassSecurityTrustUrl(unsafeImageUrl);\n            });\n          }\n\n          items.push(item);\n        });\n      } // this.dataModel.data = items;\n\n\n      return items;\n    }\n\n    setValue(responseDataModel) {\n      this.dataModel.data = responseDataModel;\n    }\n\n    setFieldData() {}\n\n    setMode(responseDataModel) {}\n\n    getImage(fileId) {\n      return new Promise((resolve, reject) => {\n        this._serverApi.download(`/api/v1/applications/${this.dataModel.globalParameters.get('applicationId')}/files/${fileId}`).subscribe(response => {\n          try {\n            if (response) {\n              resolve(response);\n            }\n\n            reject(\"error\");\n          } catch (e) {}\n        }, error => {\n          reject(error);\n        });\n      });\n    }\n\n    getFileApiData(fileId, filename) {\n      this._serverApi.download(`/api/v1/applications/${this.dataModel.globalParameters.get('applicationId')}/files/${fileId}`).subscribe(response => {\n        try {\n          if (response) {\n            this._saveFileService.saveFile(response, filename);\n          }\n        } catch (e) {}\n      }, error => {});\n    }\n\n    openFileUpload() {\n      let data = new Object();\n      this.emitEvent(\"openDialog\", data);\n    }\n\n    hasPermitActionPermission(actionName) {\n      return this._appRepoHelperService.hasPermitActionPermission(actionName);\n    }\n\n  }\n\n  PermitImagesAndFilesTabComponent.ɵfac = function PermitImagesAndFilesTabComponent_Factory(t) {\n    return new (t || PermitImagesAndFilesTabComponent)(i0.ɵɵdirectiveInject(i1.ServerApiInterfaceServiceService), i0.ɵɵdirectiveInject(i2.AppRepoHelperService), i0.ɵɵdirectiveInject(i3.SaveFileService), i0.ɵɵdirectiveInject(i4.Router), i0.ɵɵdirectiveInject(i5.DomSanitizer), i0.ɵɵdirectiveInject(i6.MatDialog), i0.ɵɵdirectiveInject(i7.ValidationService), i0.ɵɵdirectiveInject(i8.AppRepoService));\n  };\n\n  PermitImagesAndFilesTabComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PermitImagesAndFilesTabComponent,\n    selectors: [[\"app-permit-images-and-files-tab\"]],\n    inputs: {\n      dataModel: \"dataModel\",\n      configModel: \"configModel\"\n    },\n    features: [i0.ɵɵInheritDefinitionFeature],\n    decls: 12,\n    vars: 2,\n    consts: [[1, \"container-fluid\"], [1, \"row\", \"no-gutters\"], [1, \"col-md-12\"], [1, \"images-container\"], [\"fxLayout\", \"row\", \"fxLayout.lt-sm\", \"column\", \"fxLayoutAlign\", \"space-between center\", 1, \"top-info\"], [1, \"info-title\"], [\"fxLayout\", \"row\", \"fxLayoutAlign\", \"space-between center\", \"fxLayoutGap\", \"20px\", 1, \"image-actions\"], [\"mat-stroked-button\", \"\", \"color\", \"primary\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"all-images-container\", \"fxLayout\", \"row wrap\", \"fxLayout.lt-sm\", \"column\", \"fxLayoutGap\", \"32px\", \"fxLayoutAlign\", \"flex-start\", 4, \"ngIf\"], [\"mat-stroked-button\", \"\", \"color\", \"primary\", 3, \"click\"], [\"fxLayout\", \"row wrap\", \"fxLayout.lt-sm\", \"column\", \"fxLayoutGap\", \"32px\", \"fxLayoutAlign\", \"flex-start\", 1, \"all-images-container\"], [\"class\", \"single-image-container\", \"fxLayout\", \"column\", \"fxLayoutAlign\", \"start stretch\", \"fxFlex\", \"0 1 calc(25% - 32px)\", \"fxFlex.lt-md\", \"0 1 calc(50% - 32px)\", \"fxFlex.lt-sm\", \"100%\", 4, \"ngFor\", \"ngForOf\"], [\"fxLayout\", \"column\", \"fxLayoutAlign\", \"start stretch\", \"fxFlex\", \"0 1 calc(25% - 32px)\", \"fxFlex.lt-md\", \"0 1 calc(50% - 32px)\", \"fxFlex.lt-sm\", \"100%\", 1, \"single-image-container\"], [\"fxLayout\", \"column\", \"fxLayoutAlign\", \"center center\", 1, \"image-wrapper\"], [\"class\", \"fileuplod\", \"alt\", \"\", 3, \"src\", 4, \"ngIf\"], [\"class\", \"docx\", \"aria-label\", \"file\", 4, \"ngIf\"], [\"fxLayout\", \"row\", \"fxLayoutAlign\", \"space-between center\", 1, \"image-info-wrapper\"], [1, \"image-info\"], [1, \"image-action\"], [\"mat-icon-button\", \"\", \"matTooltip\", \"Click to Download\", 1, \"iconbutton\", 3, \"click\"], [\"aria-label\", \"Download\"], [\"alt\", \"\", 1, \"fileuplod\", 3, \"src\"], [\"aria-label\", \"file\", 1, \"docx\"]],\n    template: function PermitImagesAndFilesTabComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"div\", 5);\n        i0.ɵɵelementStart(6, \"h2\");\n        i0.ɵɵtext(7, \"Images & Files related to permit\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"div\", 6);\n        i0.ɵɵtemplate(9, PermitImagesAndFilesTabComponent_button_9_Template, 4, 0, \"button\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(10, \"hr\");\n        i0.ɵɵtemplate(11, PermitImagesAndFilesTabComponent_div_11_Template, 2, 1, \"div\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngIf\", ctx.hasPermitActionPermission(ctx.PERMIT_ACTIONS_CONFIG.UPLOAD));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.dataModel && ctx.dataModel.data);\n      }\n    },\n    directives: [i9.DefaultLayoutDirective, i9.DefaultLayoutAlignDirective, i9.DefaultLayoutGapDirective, i10.NgIf, i11.MatButton, i12.MatIcon, i10.NgForOf, i9.DefaultFlexDirective, i13.MatTooltip],\n    pipes: [i14.TransformDateTimePipe],\n    styles: [\".images-container[_ngcontent-%COMP%]{background:#FFFFFF 0% 0% no-repeat padding-box;box-shadow:0 3px 4px #c1cbff3b;border-radius:4px;margin-top:15px;margin-bottom:30px;padding:20px 15px 30px}.images-container[_ngcontent-%COMP%]   .info-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font:normal normal bold 1.5rem Noto Sans;letter-spacing:0px;color:#706f6f;opacity:1}.image-actions[_ngcontent-%COMP%]   .mat-stroked-button[_ngcontent-%COMP%]{padding:0 8px;line-height:25px;font-size:1.1rem;font:Noto Sans;background-color:var(--theme-color);color:#fff;border:none;border-radius:2px}.image-actions[_ngcontent-%COMP%]   .mat-stroked-button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:1.8rem;color:#fff}.image-actions[_ngcontent-%COMP%]   .mat-stroked-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{height:2rem;width:2rem}.single-image-container[_ngcontent-%COMP%]{border:1px solid #bbc6ef;background:#FFFFFF 0% 0% no-repeat padding-box;box-shadow:0 3px 6px #00000029;border:1px solid #BBC6EF69;border-radius:8px;opacity:1;margin-top:25px}.image-info-wrapper[_ngcontent-%COMP%]{padding:10px}.single-image-container[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font:normal normal bold 1.3rem Noto Sans;letter-spacing:0px;color:#706f6f;opacity:1}.single-image-container[_ngcontent-%COMP%]   .image-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font:normal normal normal 1.2rem Noto Sans;letter-spacing:0px;color:#706f6f;opacity:1;margin-bottom:2px}.single-image-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#bbc6ef}.image-wrapper[_ngcontent-%COMP%]{height:200px;border-bottom:#BBC6EF69 solid 1px;background-size:cover}.docx[_ngcontent-%COMP%]{font-size:165px;width:165px;height:165px}.fileuplod[_ngcontent-%COMP%]{max-width:275px!important;max-height:195px!important}\"]\n  });\n  return PermitImagesAndFilesTabComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}