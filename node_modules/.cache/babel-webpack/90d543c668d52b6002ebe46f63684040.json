{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { REMEMBER_ME_DATA, SESSION_STORAGE_DATA_KEY } from 'src/app/app-constants';\nimport { ErrorCodes } from 'src/app/models/common/error-codes';\nimport { HttpHeaders } from '@angular/common/http';\nimport { LoginAPIRequest } from 'src/app/models/dto/user-management/login-request';\nimport { THEMING_VARIABLE } from 'src/app/constants/app-repo.constants';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"src/app/services/session-storage.service\";\nimport * as i4 from \"src/app/services/server-api-interface-service.service\";\nimport * as i5 from \"src/app/services/notification.service\";\nimport * as i6 from \"src/app/services/elgin-start-up.service\";\nimport * as i7 from \"src/app/services/encrypt-decrypt.service\";\nimport * as i8 from \"src/app/services/local-storage.service\";\nimport * as i9 from \"ngx-spinner\";\nimport * as i10 from \"src/app/theme/theme.service\";\nimport * as i11 from \"src/app/services/app-repo.service\";\nimport * as i12 from \"@angular/flex-layout/flex\";\nimport * as i13 from \"@angular/common\";\nimport * as i14 from \"@angular/material/form-field\";\nimport * as i15 from \"@angular/material/input\";\nimport * as i16 from \"@angular/material/button\";\nimport * as i17 from \"@angular/material/icon\";\nimport * as i18 from \"@angular/material/checkbox\";\nimport * as i19 from \"@angular/material/tooltip\";\n\nfunction LoginComponent_img_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 27);\n  }\n}\n\nfunction LoginComponent_img_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 28);\n  }\n}\n\nfunction LoginComponent_h1_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h1\");\n    i0.ɵɵtext(1, \"Streetworks in a Skewb\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction LoginComponent_img_45_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 29);\n  }\n} // import { theme } from 'src/app/theme/all-theme/nwl-theme';\n\n\nexport let LoginComponent = /*#__PURE__*/(() => {\n  class LoginComponent {\n    constructor(_router, _formbuilder, _sessionStorageService, _serverApi, _notificationService, _elginSessionStorage, route, _encryptDecryptService, _localStorageService, _spinner, _themeService, _appRepoService) {\n      this._router = _router;\n      this._formbuilder = _formbuilder;\n      this._sessionStorageService = _sessionStorageService;\n      this._serverApi = _serverApi;\n      this._notificationService = _notificationService;\n      this._elginSessionStorage = _elginSessionStorage;\n      this.route = route;\n      this._encryptDecryptService = _encryptDecryptService;\n      this._localStorageService = _localStorageService;\n      this._spinner = _spinner;\n      this._themeService = _themeService;\n      this._appRepoService = _appRepoService;\n      this.isInvalidUser = false;\n      this.isSVGimagerender = false;\n      this.messageSuccess = false;\n      this.hide = true; // key: string = \"6LcvoUgUAAAAAJJbhcXvLn3KgG-pyULLusaU4mL1\";\n\n      this.siteKey = '6LcvoUgUAAAAAJJbhcXvLn3KgG-pyULLusaU4mL1';\n      this.type = 'image';\n      this.isopuslogorender = false;\n      this.uiVersion = 'v1.1.1.1';\n      this.data = new LoginAPIRequest();\n    }\n\n    ngOnInit() {\n      this._sessionStorageService.clearSessionStorage();\n\n      this.initializeForm();\n\n      if (this._appRepoService.appRepo.navigationData.get(THEMING_VARIABLE.ISSVGRENDERPERMMISTION) == \"true\") {\n        this.isSVGimagerender = true;\n      }\n\n      if (this._appRepoService.appRepo.navigationData.get(THEMING_VARIABLE.ISOPUSLOGORENDERPERMMISIION) == \"true\") {\n        this.isopuslogorender = true;\n      }\n\n      console.log(\"uiVersion\", this.uiVersion);\n    }\n\n    initializeForm() {\n      this.loginForm = this._formbuilder.group({\n        // userpassword: [\"\", Validators.required],\n        userId: ['', Validators.required],\n        password: ['', Validators.required],\n        // langId: ['', Validators.required],\n        rememberMe: [true]\n      });\n      this.getAndBindRememberMeData();\n    }\n\n    getAndBindRememberMeData() {\n      let decryptedRememberMeData = JSON.parse(this._encryptDecryptService.decrypt(this._localStorageService.getObject(REMEMBER_ME_DATA)));\n\n      if (decryptedRememberMeData != null) {\n        this.loginForm.controls['userId'].setValue(decryptedRememberMeData.userId);\n        this.loginForm.controls['password'].setValue(decryptedRememberMeData.password);\n      }\n    }\n\n    resolved(captchaResponse) {\n      this.recaptchaResponse = captchaResponse;\n    }\n\n    authenticateUser() {\n      // let userpassword = this.loginForm.get(\"userpassword\").value;\n      this.AuthenticateAndRedirect();\n    }\n\n    AuthenticateAndRedirect() {\n      this.loginForm.markAllAsTouched();\n\n      if (this.loginForm.valid) {\n        const userdata = new LoginAPIRequest();\n        userdata.username = this.loginForm.get(\"userId\").value;\n        userdata.password = this.loginForm.get(\"password\").value;\n        this.rememberUserCredentials();\n        let offset = new Date().getTimezoneOffset();\n        offset = `${offset * -1}`;\n        let headers = new HttpHeaders({\n          ClientTZOffSet: offset\n        });\n\n        this._spinner.show();\n\n        this._serverApi.post(\"/api/v1/user/authenticate\", userdata, headers).subscribe(response => {\n          this._spinner.hide();\n\n          this.onLoginSuccess(response);\n        }, error => {\n          this.isInvalidUser = true;\n\n          switch (error.code) {\n            case ErrorCodes.ERR_INVALID_USER_NAME:\n              this._notificationService.error(\"Invalid User Name\");\n\n              break;\n\n            case ErrorCodes.ERR_INVALID_USER_PASSWORD:\n              this._notificationService.error(\"Invalid Password\");\n\n              break;\n\n            case ErrorCodes.ERR_DATABASE:\n              this._notificationService.error(\"Server Error\");\n\n              break;\n          }\n\n          this._spinner.hide();\n        });\n      }\n    }\n\n    rememberUserCredentials() {\n      if (this.loginForm.controls.rememberMe.value) {\n        let encryptedRememberMeData = this._encryptDecryptService.encrypt(JSON.stringify({\n          'userId': this.loginForm.controls.userId.value,\n          'password': this.loginForm.controls.password.value\n        }));\n\n        this._localStorageService.setObject(REMEMBER_ME_DATA, encryptedRememberMeData);\n      } else {\n        this._localStorageService.removeObject(REMEMBER_ME_DATA);\n      }\n    }\n\n    onKey(event) {\n      this.isInvalidUser = false;\n    }\n\n    onLoginSuccess(response) {\n      this._sessionStorageService.setObject(SESSION_STORAGE_DATA_KEY.SESSION_TOKEN, response.token);\n\n      this._sessionStorageService.setObject(SESSION_STORAGE_DATA_KEY.USER_NAME, this.loginForm.get(\"userId\").value); // this._router.navigate(['/admin/pcp-management-dashboard']);\n\n\n      this._router.navigate(['/admin/pcp-operational-dashboard']);\n    }\n\n  }\n\n  LoginComponent.ɵfac = function LoginComponent_Factory(t) {\n    return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.SessionStorageService), i0.ɵɵdirectiveInject(i4.ServerApiInterfaceServiceService), i0.ɵɵdirectiveInject(i5.NotificationService), i0.ɵɵdirectiveInject(i6.ElginStartUpService), i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i7.EncryptDecryptService), i0.ɵɵdirectiveInject(i8.LocalStorageService), i0.ɵɵdirectiveInject(i9.NgxSpinnerService), i0.ɵɵdirectiveInject(i10.ThemeService), i0.ɵɵdirectiveInject(i11.AppRepoService));\n  };\n\n  LoginComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LoginComponent,\n    selectors: [[\"app-login\"]],\n    inputs: {\n      siteKey: \"siteKey\",\n      type: \"type\"\n    },\n    decls: 47,\n    vars: 9,\n    consts: [[1, \"login-page-container\"], [1, \"container\", \"h-100\"], [1, \"row\", \"h-100\", \"no-gutters\"], [1, \"col-sm-4\", \"my-auto\"], [1, \"login-card\"], [1, \"login-form-container\"], [\"fxLayout\", \"column\", \"fxLayoutAlign\", \"space-between center\"], [\"src\", \"assets/images/logo_login.png\", \"alt\", \"_logo_murphy\", \"class\", \"logo-murphy\", 4, \"ngIf\"], [\"src\", \"assets/images/logo_login.svg\", \"alt\", \"_logo_murphy\", \"class\", \"logo-murphy\", 4, \"ngIf\"], [\"fxLayout\", \"column\", \"fxLayoutAlign\", \"space-between none\", 1, \"login-form\", 3, \"formGroup\"], [1, \"login-form-title\"], [\"appearance\", \"outline\"], [\"required\", \"\", \"matInput\", \"\", \"placeholder\", \"Enter user id\", \"autocomplete\", \"off\", \"value\", \"sm@Murphy.uk\", \"formControlName\", \"userId\"], [\"required\", \"\", \"matInput\", \"\", \"placeholder\", \"Enter your password\", \"autocomplete\", \"off\", \"formControlName\", \"password\", 3, \"type\"], [\"type\", \"button\", \"mat-icon-button\", \"\", \"matSuffix\", \"\", 3, \"click\"], [\"fxLayout\", \"row\", \"fxLayoutAlign\", \"space-between start\", 1, \"login-form-links\"], [\"formControlName\", \"rememberMe\"], [\"matTooltip\", \"Reset Password\"], [2, \"text-align\", \"center\"], [\"type\", \"submit\", \"mat-raised-button\", \"\", \"color\", \"primary\", 2, \"width\", \"50%\", \"text-align\", \"center\", 3, \"click\"], [\"fxLayout\", \"row\", \"fxLayoutAlign\", \"space-between start\", \"fxLayoutGap\", \"10px\", 1, \"login-form-term-links\"], [\"fxLayout\", \"column\", \"fxLayoutAlign\", \"space-between center\", 1, \"col-sm-8\", \"my-auto\"], [1, \"Landingtitles\"], [4, \"ngIf\"], [1, \"text-center\"], [\"class\", \"opuslogo\", \"src\", \"assets/images/opuslogo.png\", \"alt\", \"opuslogo\", 4, \"ngIf\"], [\"src\", \"assets/images/login-bg.png\", \"alt\", \"_logo_murphy\", 2, \"width\", \"95%\", \"float\", \"right\"], [\"src\", \"assets/images/logo_login.png\", \"alt\", \"_logo_murphy\", 1, \"logo-murphy\"], [\"src\", \"assets/images/logo_login.svg\", \"alt\", \"_logo_murphy\", 1, \"logo-murphy\"], [\"src\", \"assets/images/opuslogo.png\", \"alt\", \"opuslogo\", 1, \"opuslogo\"]],\n    template: function LoginComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"div\", 5);\n        i0.ɵɵelementStart(6, \"div\", 6);\n        i0.ɵɵtemplate(7, LoginComponent_img_7_Template, 1, 0, \"img\", 7);\n        i0.ɵɵtemplate(8, LoginComponent_img_8_Template, 1, 0, \"img\", 8);\n        i0.ɵɵelementStart(9, \"form\", 9);\n        i0.ɵɵelementStart(10, \"h2\", 10);\n        i0.ɵɵtext(11, \"Welcome back, Please login to your account.\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"mat-form-field\", 11);\n        i0.ɵɵelementStart(13, \"mat-label\");\n        i0.ɵɵtext(14, \"User Id \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(15, \"input\", 12);\n        i0.ɵɵelementStart(16, \"mat-error\");\n        i0.ɵɵtext(17, \"User Id must be valid \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"mat-form-field\", 11);\n        i0.ɵɵelementStart(19, \"mat-label\");\n        i0.ɵɵtext(20, \"Password\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(21, \"input\", 13);\n        i0.ɵɵelementStart(22, \"button\", 14);\n        i0.ɵɵlistener(\"click\", function LoginComponent_Template_button_click_22_listener() {\n          return ctx.hide = !ctx.hide;\n        });\n        i0.ɵɵelementStart(23, \"mat-icon\");\n        i0.ɵɵtext(24);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"mat-error\");\n        i0.ɵɵtext(26, \"Password must be valid\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"div\", 15);\n        i0.ɵɵelementStart(28, \"mat-checkbox\", 16);\n        i0.ɵɵtext(29, \"Remember Me\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"a\", 17);\n        i0.ɵɵtext(31, \"Forgot Password\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"div\", 18);\n        i0.ɵɵelementStart(33, \"button\", 19);\n        i0.ɵɵlistener(\"click\", function LoginComponent_Template_button_click_33_listener() {\n          return ctx.authenticateUser();\n        });\n        i0.ɵɵtext(34, \"Login\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(35, \"div\", 20);\n        i0.ɵɵelementStart(36, \"a\");\n        i0.ɵɵtext(37, \"Terms of use\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"a\");\n        i0.ɵɵtext(39, \"Privacy Policy\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"div\", 21);\n        i0.ɵɵelementStart(41, \"div\", 22);\n        i0.ɵɵelementStart(42, \"div\");\n        i0.ɵɵtemplate(43, LoginComponent_h1_43_Template, 2, 0, \"h1\", 23);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(44, \"div\", 24);\n        i0.ɵɵtemplate(45, LoginComponent_img_45_Template, 1, 0, \"img\", 25);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(46, \"img\", 26);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isSVGimagerender);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isSVGimagerender);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"formGroup\", ctx.loginForm);\n        i0.ɵɵadvance(12);\n        i0.ɵɵproperty(\"type\", ctx.hide ? \"password\" : \"text\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵattribute(\"aria-label\", \"Hide password\")(\"aria-pressed\", ctx.hide);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.hide ? \"visibility_off\" : \"visibility\");\n        i0.ɵɵadvance(19);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isopuslogorender);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.isopuslogorender);\n      }\n    },\n    directives: [i12.DefaultLayoutDirective, i12.DefaultLayoutAlignDirective, i13.NgIf, i2.ɵNgNoValidate, i2.NgControlStatusGroup, i2.FormGroupDirective, i14.MatFormField, i14.MatLabel, i15.MatInput, i2.DefaultValueAccessor, i2.RequiredValidator, i2.NgControlStatus, i2.FormControlName, i14.MatError, i16.MatButton, i14.MatSuffix, i17.MatIcon, i18.MatCheckbox, i19.MatTooltip, i12.DefaultLayoutGapDirective],\n    styles: [\".login-page-container[_ngcontent-%COMP%]{height:100%}.login-card[_ngcontent-%COMP%]{background:white 0% 0% no-repeat padding-box;box-shadow:0 10px 20px #00000029;-ms-box-shadow:0px 10px 20px #00000029;-webkit-box-shadow:0px 10px 20px #00000029;-moz-box-shadow:0px 10px 20px #00000029;border-radius:6px;opacity:1;padding:4rem 4rem 1rem}.logo-murphy[_ngcontent-%COMP%]{width:auto;height:12rem;text-align:center;max-width:100%}.login-form-title[_ngcontent-%COMP%]{font-family:Noto Sans;font-weight:normal;font-size:1.3rem;margin-top:2.5rem;margin-bottom:2.5rem;text-align:center;letter-spacing:0px;color:#4d4f5c;opacity:.5}.login-form[_ngcontent-%COMP%]{width:100%}.login-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-bottom:1.3rem}.login-form-links[_ngcontent-%COMP%]{font-family:Noto Sans;margin-bottom:2.5rem;font-size:1.3rem;color:#706f6f}.login-form-term-links[_ngcontent-%COMP%]{font-family:Noto Sans;margin-top:4rem;font-size:1.3rem;color:#706f6f}.Landingtitles[_ngcontent-%COMP%]{padding-left:5rem}.Landingtitles[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Noto Sans;font-weight:bold;font-size:2.5rem;text-align:left;letter-spacing:0px;color:var(--login-page-subtitle-color);margin-bottom:0}.Landingtitles[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Noto Sans;font-weight:bold;font-size:2.5rem;text-align:left;letter-spacing:0px;color:var(--login-page-title-color);margin-top:0}.powered-by-logo[_ngcontent-%COMP%]{margin-top:1rem;font-size:1.3rem;color:#706f6f}.powered-by-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:5rem}.opuslogo[_ngcontent-%COMP%]{width:33%}\"]\n  });\n  return LoginComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}