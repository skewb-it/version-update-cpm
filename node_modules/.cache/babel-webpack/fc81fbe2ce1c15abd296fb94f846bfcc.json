{"ast":null,"code":"import { GLOBAL_PERSISTANT_DATA } from 'src/app/constants/app-repo.constants';\nimport { MASTER_DATA_DOMAIN } from 'src/app/constants/db.constants';\nimport { WidgetComponentBase } from 'src/app/utility/widget/widget-utility/widget-component-base';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/server-api-interface-service.service\";\nimport * as i2 from \"src/app/services/app-repo-helper.service\";\nimport * as i3 from \"@angular/material/dialog\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"src/app/services/validation.service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"primeng/api\";\nimport * as i8 from \"@angular/flex-layout/flex\";\nimport * as i9 from \"@angular/material/form-field\";\nimport * as i10 from \"@angular/material/select\";\nimport * as i11 from \"@angular/material/input\";\nimport * as i12 from \"@angular/material/datepicker\";\nimport * as i13 from \"@angular/material/button-toggle\";\nimport * as i14 from \"@angular/material/core\";\n\nfunction PerformanceSelectGroupComponent_mat_option_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const highWayAuthority_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", highWayAuthority_r5.authorityId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", highWayAuthority_r5.name, \"\");\n  }\n}\n\nfunction PerformanceSelectGroupComponent_mat_option_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const d_r6 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", d_r6.contractor_id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(d_r6.contractor_name);\n  }\n}\n\nfunction PerformanceSelectGroupComponent_mat_option_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const d_r7 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", d_r7.orgId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(d_r7.name);\n  }\n}\n\nexport let PerformanceSelectGroupComponent = /*#__PURE__*/(() => {\n  class PerformanceSelectGroupComponent extends WidgetComponentBase {\n    constructor(_serverApiBase, _appRepoHelperService, dialog, fb, _validationService, datePipe, primengConfig) {\n      super(_serverApiBase, _validationService);\n      this._serverApiBase = _serverApiBase;\n      this._appRepoHelperService = _appRepoHelperService;\n      this.dialog = dialog;\n      this.fb = fb;\n      this._validationService = _validationService;\n      this.datePipe = datePipe;\n      this.primengConfig = primengConfig;\n      this.arrPromoterOrgnisation = [];\n      this.arrContractors = [];\n      this.allArrContractors = [];\n      this.arrHighwayAuthority = [];\n      this.selectedcontractor = [];\n      this.selectedHighwayAuthority = [];\n      this.selectedPromoterOrgnisation = [];\n      this.contractorData = [];\n      this.highwayAuthorityData = [];\n      this.promoterOrgnisationData = [];\n      this.duration = 'TODAY';\n      this.primengConfig.ripple = true;\n    }\n\n    ngOnInit() {\n      this.wgFormData = new Object();\n      this.createFormGroup();\n      this.wgOnInit();\n    }\n\n    createFormGroup() {\n      this.wgFormGroup = this.fb.group({\n        workstream: [''],\n        contractor: [''],\n        highwayAuthority: [''],\n        startDate: [''],\n        endDate: ['']\n      });\n    }\n\n    setFieldData() {\n      this.allArrContractors = this._appRepoHelperService.getMDataByDomain(MASTER_DATA_DOMAIN.USER_ACCESS_CONTRACTOR);\n      this.arrContractors = this.allArrContractors.filter((thing, i, arr) => {\n        return arr.indexOf(arr.find(t => t.contractor_id === thing.contractor_id)) === i;\n      });\n      this.arrPromoterOrgnisation = this._appRepoHelperService.getMDataByDomain(MASTER_DATA_DOMAIN.USER_ACCESS_ORG);\n      this.arrHighwayAuthority = this._appRepoHelperService.getMDataByDomain(MASTER_DATA_DOMAIN.HIGHWAY_AUTORITIES);\n    }\n\n    getControlData() {\n      return new Promise((resolve, rejects) => {\n        resolve(null);\n      });\n    }\n\n    convertData(response) {}\n\n    setMode(responseDataModel) {}\n\n    setValue(responseDataModel) {\n      let contracotr = this._appRepoHelperService.getGlobalPersistantData(GLOBAL_PERSISTANT_DATA.SELECTED_CONTRACTOR);\n\n      let organisation = this._appRepoHelperService.getGlobalPersistantData(GLOBAL_PERSISTANT_DATA.SELECTED_PROMOTER_ORGNISATION);\n\n      let highwayAuthority = this._appRepoHelperService.getGlobalPersistantData(GLOBAL_PERSISTANT_DATA.SELECTED_HIGHWAY_AUTHORITY);\n\n      this.wgFormGroup.controls.contractor.setValue(contracotr);\n      this.wgFormGroup.controls.workstream.setValue(organisation);\n      this.wgFormGroup.controls.highwayAuthority.setValue(highwayAuthority); // console.log(\"organisation\",organisation)\n      // this.selectedPromoterOrgnisation = [];\n      // this.selectedPromoterOrgnisation = this.arrPromoterOrgnisation.filter((d: any) => { return organisation.indexOf(d.orgId) > -1 });\n      // this.selectedcontractor = [];\n      // this.selectedcontractor = this.allArrContractors.filter((d: any) => { return contracotr.indexOf(d.contractor_id) > -1 });\n      // this.selectedHighwayAuthority = [];\n      // this.selectedHighwayAuthority = this.arrHighwayAuthority.filter((d: any) => { return highwayAuthority.indexOf(d.authorityId) > -1 });\n    }\n\n    getValue() {\n      // const contractor = this.wgFormGroup.controls.contractor.value ?\n      //   this.wgFormGroup.controls.contractor.value : null;\n      // this.wgFormData.contractor = contractor;\n      const contractor = this.contractorData.length > 0 ? this.contractorData : null;\n      this.wgFormData.contractor = contractor; // const promoterOrganisation = this.wgFormGroup.controls.promoterOrganisation.value ?\n      //   this.wgFormGroup.controls.promoterOrganisation.value : null;\n      // this.wgFormData.promoterOrganisation = promoterOrganisation;\n\n      const promoterOrganisation = this.promoterOrgnisationData.length > 0 ? this.promoterOrgnisationData : null;\n      this.wgFormData.promoterOrganisation = promoterOrganisation; // const highwayAuthority = this.wgFormGroup.controls.highwayAuthority.value ?\n      //   this.wgFormGroup.controls.highwayAuthority.value : null;\n      // this.wgFormData.highwayAuthority = highwayAuthority;\n\n      const highwayAuthority = this.highwayAuthorityData.length > 0 ? this.highwayAuthorityData : null;\n      this.wgFormData.highwayAuthority = highwayAuthority;\n      return this.wgFormData;\n    }\n\n    onChangePromoterOrgnisation(value) {\n      // console.log(\"value\",value)\n      this.wgFormGroup.controls.contractor.setValue(null);\n      this.promoterOrgnisationData = [];\n      this.promoterOrgnisationData.length = 0;\n      value.forEach(item => {\n        this.promoterOrgnisationData.push(item);\n      }); // console.log(\"promoterOrgnisationData\",this.promoterOrgnisationData)\n\n      if (this.promoterOrgnisationData.length > 0) {\n        this.arrContractors = this.allArrContractors.filter(d => {\n          return this.promoterOrgnisationData.indexOf(d.org_id) > -1;\n        });\n        this.arrContractors = this.arrContractors.filter((thing, i, arr) => {\n          return arr.indexOf(arr.find(t => t.contractor_id === thing.contractor_id)) === i;\n        });\n      } else {\n        this.arrContractors = this.allArrContractors.filter((thing, i, arr) => {\n          return arr.indexOf(arr.find(t => t.contractor_id === thing.contractor_id)) === i;\n        });\n      }\n\n      this.emitEvent('ON_GLOBAL_FILTER_CHANGE', this.promoterOrgnisationData);\n    }\n\n    onChangeContractor(value) {\n      this.contractorData = [];\n      this.contractorData.length = 0;\n      value.forEach(item => {\n        this.contractorData.push(item);\n      });\n      this.emitEvent('ON_GLOBAL_FILTER_CHANGE', this.contractorData);\n    }\n\n    onChangeHighwayAuthority(value) {\n      this.highwayAuthorityData = [];\n      this.highwayAuthorityData.length = 0;\n      value.forEach(item => {\n        this.highwayAuthorityData.push(item);\n      });\n      this.emitEvent('ON_GLOBAL_FILTER_CHANGE', this.highwayAuthorityData);\n    }\n\n    onChangeButtonToggle(event) {\n      this.emitEvent('onChangeWeek', event);\n    }\n\n  }\n\n  PerformanceSelectGroupComponent.ɵfac = function PerformanceSelectGroupComponent_Factory(t) {\n    return new (t || PerformanceSelectGroupComponent)(i0.ɵɵdirectiveInject(i1.ServerApiInterfaceServiceService), i0.ɵɵdirectiveInject(i2.AppRepoHelperService), i0.ɵɵdirectiveInject(i3.MatDialog), i0.ɵɵdirectiveInject(i4.FormBuilder), i0.ɵɵdirectiveInject(i5.ValidationService), i0.ɵɵdirectiveInject(i6.DatePipe), i0.ɵɵdirectiveInject(i7.PrimeNGConfig));\n  };\n\n  PerformanceSelectGroupComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PerformanceSelectGroupComponent,\n    selectors: [[\"app-performance-select-group\"]],\n    inputs: {\n      dataModel: \"dataModel\",\n      configModel: \"configModel\"\n    },\n    features: [i0.ɵɵInheritDefinitionFeature],\n    decls: 49,\n    vars: 9,\n    consts: [[1, \"d-flex\", \"flex-column\"], [3, \"formGroup\"], [\"fxLayout\", \"column\", \"fxLayoutAlign\", \"end\"], [\"appearance\", \"fill\"], [\"formControlName\", \"highwayAuthority\", \"multiple\", \"\", 3, \"selectionChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"formControlName\", \"contractor\", \"multiple\", \"\", 3, \"selectionChange\"], [\"multiple\", \"\", \"formControlName\", \"workstream\", 3, \"selectionChange\"], [\"matInput\", \"\", \"formControlName\", \"startDate\", 3, \"matDatepicker\", \"click\", \"focus\"], [\"matSuffix\", \"\", 3, \"for\"], [\"startDate\", \"\"], [\"matInput\", \"\", \"formControlName\", \"endDate\", 3, \"matDatepicker\", \"click\", \"focus\"], [\"endDate\", \"\"], [\"vertical\", \"true\", \"aria-label\", \"Font Style\", 1, \"col-12\", \"p-0\", 3, \"ngModel\", \"change\", \"ngModelChange\"], [\"value\", \"TODAY\", 1, \"text-left\"], [1, \"material-icons\"], [\"value\", \"WEEK\"], [\"value\", \"MONTH\"], [\"value\", \"FIN_YEAR\"], [3, \"value\"]],\n    template: function PerformanceSelectGroupComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r8 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"form\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"mat-form-field\", 3);\n        i0.ɵɵelementStart(4, \"mat-label\");\n        i0.ɵɵtext(5, \"Highway Authority\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"mat-select\", 4);\n        i0.ɵɵlistener(\"selectionChange\", function PerformanceSelectGroupComponent_Template_mat_select_selectionChange_6_listener($event) {\n          return ctx.onChangeHighwayAuthority($event.value);\n        });\n        i0.ɵɵtemplate(7, PerformanceSelectGroupComponent_mat_option_7_Template, 2, 2, \"mat-option\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"mat-form-field\", 3);\n        i0.ɵɵelementStart(9, \"mat-label\");\n        i0.ɵɵtext(10, \"Contractor\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"mat-select\", 6);\n        i0.ɵɵlistener(\"selectionChange\", function PerformanceSelectGroupComponent_Template_mat_select_selectionChange_11_listener($event) {\n          return ctx.onChangeContractor($event.value);\n        });\n        i0.ɵɵtemplate(12, PerformanceSelectGroupComponent_mat_option_12_Template, 2, 2, \"mat-option\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"mat-form-field\", 3);\n        i0.ɵɵelementStart(14, \"mat-label\");\n        i0.ɵɵtext(15, \"Workstream\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"mat-select\", 7);\n        i0.ɵɵlistener(\"selectionChange\", function PerformanceSelectGroupComponent_Template_mat_select_selectionChange_16_listener($event) {\n          return ctx.onChangePromoterOrgnisation($event.value);\n        });\n        i0.ɵɵtemplate(17, PerformanceSelectGroupComponent_mat_option_17_Template, 2, 2, \"mat-option\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"mat-form-field\", 3);\n        i0.ɵɵelementStart(19, \"mat-label\");\n        i0.ɵɵtext(20, \"Start Date\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"input\", 8);\n        i0.ɵɵlistener(\"click\", function PerformanceSelectGroupComponent_Template_input_click_21_listener() {\n          i0.ɵɵrestoreView(_r8);\n\n          const _r3 = i0.ɵɵreference(24);\n\n          return _r3.open();\n        })(\"focus\", function PerformanceSelectGroupComponent_Template_input_focus_21_listener() {\n          i0.ɵɵrestoreView(_r8);\n\n          const _r3 = i0.ɵɵreference(24);\n\n          return _r3.open();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(22, \"mat-datepicker-toggle\", 9);\n        i0.ɵɵelement(23, \"mat-datepicker\", null, 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"mat-form-field\", 3);\n        i0.ɵɵelementStart(26, \"mat-label\");\n        i0.ɵɵtext(27, \"End Date\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"input\", 11);\n        i0.ɵɵlistener(\"click\", function PerformanceSelectGroupComponent_Template_input_click_28_listener() {\n          i0.ɵɵrestoreView(_r8);\n\n          const _r4 = i0.ɵɵreference(31);\n\n          return _r4.open();\n        })(\"focus\", function PerformanceSelectGroupComponent_Template_input_focus_28_listener() {\n          i0.ɵɵrestoreView(_r8);\n\n          const _r4 = i0.ɵɵreference(31);\n\n          return _r4.open();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(29, \"mat-datepicker-toggle\", 9);\n        i0.ɵɵelement(30, \"mat-datepicker\", null, 12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"mat-button-toggle-group\", 13);\n        i0.ɵɵlistener(\"change\", function PerformanceSelectGroupComponent_Template_mat_button_toggle_group_change_32_listener($event) {\n          return ctx.onChangeButtonToggle($event);\n        })(\"ngModelChange\", function PerformanceSelectGroupComponent_Template_mat_button_toggle_group_ngModelChange_32_listener($event) {\n          return ctx.duration = $event;\n        });\n        i0.ɵɵelementStart(33, \"mat-button-toggle\", 14);\n        i0.ɵɵelementStart(34, \"span\", 15);\n        i0.ɵɵtext(35, \" today \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(36, \"Today\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"mat-button-toggle\", 16);\n        i0.ɵɵelementStart(38, \"span\", 15);\n        i0.ɵɵtext(39, \" today \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(40, \"This Week\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"mat-button-toggle\", 17);\n        i0.ɵɵelementStart(42, \"span\", 15);\n        i0.ɵɵtext(43, \" today \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(44, \"This Month\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(45, \"mat-button-toggle\", 18);\n        i0.ɵɵelementStart(46, \"span\", 15);\n        i0.ɵɵtext(47, \" today \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(48, \"This Year\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r3 = i0.ɵɵreference(24);\n\n        const _r4 = i0.ɵɵreference(31);\n\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"formGroup\", ctx.wgFormGroup);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngForOf\", ctx.arrHighwayAuthority);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngForOf\", ctx.arrContractors);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngForOf\", ctx.arrPromoterOrgnisation);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"matDatepicker\", _r3);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"for\", _r3);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"matDatepicker\", _r4);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"for\", _r4);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.duration);\n      }\n    },\n    directives: [i4.ɵNgNoValidate, i4.NgControlStatusGroup, i4.FormGroupDirective, i8.DefaultLayoutDirective, i8.DefaultLayoutAlignDirective, i9.MatFormField, i9.MatLabel, i10.MatSelect, i4.NgControlStatus, i4.FormControlName, i6.NgForOf, i11.MatInput, i4.DefaultValueAccessor, i12.MatDatepickerInput, i12.MatDatepickerToggle, i9.MatSuffix, i12.MatDatepicker, i13.MatButtonToggleGroup, i4.NgModel, i13.MatButtonToggle, i14.MatOption],\n    styles: [\"\"]\n  });\n  return PerformanceSelectGroupComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}