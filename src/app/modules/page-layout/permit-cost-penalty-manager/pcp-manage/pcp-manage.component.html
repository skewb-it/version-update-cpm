<div class="container-fluid permit-view">
  <div class="row no-gutters">
    <div class="col-md-12">
      <div class="permit-info-container" fxLayout="row" fxLayout.lt-sm="column" fxLayoutAlign="space-between center">
        <div class="permit-title">
          <h1> {{ this.permitOverviewDataModel.data.permitRefNumber }}

          </h1>
        </div>
      </div>
      <div class="permit-tabs">
        <mat-tab-group (selectedTabChange)="onTabChanged($event)">

          <!--Old Overview Tab-->
          <!-- <mat-tab label="Overview">
                        <div class="container-fluid">
                            <div class="col-sm-12 col-md-12 col-lg-12">
                                <div class="row" fxLayoutGap="20px">
                                    <div class="column" fxFlex="38.5">
                                        <div class="permit-details">
                                            <app-pcp-manage-primary-details [dataModel]="pcpManagePrimaryDetailsDataModel" [configModel]="pcpManagePrimaryDetailsConfigModel"></app-pcp-manage-primary-details>
                                        </div>
                                    </div>
                                    <div class="column" fxFlex="33">
                                        <app-permit-activity-log-tab fxFlex="100" [dataModel]="permitActivityLogModel" [configModel]="permitActivityLogConfigModel"></app-permit-activity-log-tab>
                                    </div>
                                    <div class="column" fxFlex="25">
                                        <div class="permit-key-details">
                                            <div class="status-container" fxLayout="column" fxLayoutGap="10px">
                                                <div fxLayout="row" fxLayoutAlign="space-between end">
                                                    <div class="status-label mb-1" fxFlex="60">Reconciliation Status </div>
                                                    <span class="status-label mb-1" fxFlex="40" class="status-1">Open</span>
                                                </div>
                                                <div fxLayout="row" fxLayoutAlign="space-between end">
                                                    <div fxFlex="60">Payment Status</div>
                                                    <span fxFlex="40" class="status-2">Paid</span>
                                                </div>
                                            </div>
                                            <hr>
                                            <div class="stepper-cost-container">
                                                <app-stepper-cost [dataModel]="stepperCostDataModel" [configModel]="stepperCostConfigModel">
                                                </app-stepper-cost>
                                            </div>
                                            <hr>
                                            <app-pcp-manage-actions [dataModel]="pcpManageActionsDataModel" [configModel]="pcpManageActionsConfigModel"></app-pcp-manage-actions>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </mat-tab> -->

          <mat-tab label="Overview">
            <!-- <app-permit-overview-tab [dataModel]="permitOverviewDataModel" [configModel]="permitOverviewConfigModel">
                        </app-permit-overview-tab> -->

            <div class="row m-0">
              <div class="col-md-9 pl-0">
                <app-permit-overview-tab [dataModel]="permitOverviewDataModel"
                  [configModel]="permitOverviewConfigModel">
                </app-permit-overview-tab>
              </div>
              <div class="col-md-3 pr-0">
                <app-permit-key-details [dataModel]="permitKeyDetailsDataModel"
                  [configModel]="permitKeyDetailsConfigModel"></app-permit-key-details>
              </div>
            </div>

          </mat-tab>


          <mat-tab label="Estimated Charges">
            <div class="container-fluid">
              <div class="row">
                <div class="col-md-12">
                  <div fxLayout="column" fxLayoutGap="2px">
                    <div class="estimated-charges pr-4" fxLayout="row" fxLayoutAlign="space-between start">
                      <!-- <div fxFlex="80">
                                                <app-duration-viewer-chart [dataModel]="durationViewerChartDataModel" [configModel]="durationViewerChartConfigModel">
                                                </app-duration-viewer-chart>
                                            </div> -->
                      <!-- <div fxFlex="20" fxLayout="column" fxLayoutGap="10px"> -->
                      <app-charges-and-amount-card fxFlex="30" [dataModel]="chargesAmountCardDataModel5"
                        [configModel]="chargesAmountCardConfigModel5"></app-charges-and-amount-card>
                      <app-charges-and-amount-card fxFlex="30" [dataModel]="chargesAmountCardDataModel6"
                        [configModel]="chargesAmountCardConfigModel6"></app-charges-and-amount-card>
                      <app-charges-and-amount-card fxFlex="32" [dataModel]="chargesAmountCardDataModel7"
                        [configModel]="chargesAmountCardConfigModel7"></app-charges-and-amount-card>
                      <!-- </div> -->
                    </div>
                    <div class="charges-list estimated-charges mt-3">
                      <h3 class="heading"> Estimated Permit Charges</h3>
                      <app-edit-permit-cost-list [dataModel]="editPermitCostListDataModel1"
                        [configModel]="editPermitCostListConfigModel1"></app-edit-permit-cost-list>
                    </div>
                    <div class="charges-list estimated-charges mt-3">
                      <h3 class="heading">Estimated Avoidable Charges</h3>
                      <app-edit-permit-cost-list [dataModel]="editPermitCostListDataModel2"
                        [configModel]="editPermitCostListConfigModel2"></app-edit-permit-cost-list>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </mat-tab>

          <mat-tab label="Invoiced charges & Reconciliation">
            <div class="container-fluid">
              <div class="row">
                <div class="col-md-12">
                  <div fxLayout="row" fxLayoutGap="20px">
                    <div fxFlex="80">
                      <div fxLayout="column" fxLayoutGap="1px">
                        <div class="charges-card invoiced-charges pr-4" fxLayout="row" fxLayoutGap="10px">
                          <div fxFlex="6"></div>
                          <div fxFlex="94">
                            <div fxLayout="row" fxLayoutAlign="space-around center" fxLayoutGap="10px">
                              <app-charges-and-amount-card fxFlex="24" [dataModel]="chargesAmountCardDataModel1"
                                [configModel]="chargesAmountCardConfigModel1"></app-charges-and-amount-card>
                              <app-charges-and-amount-card fxFlex="29" [dataModel]="chargesAmountCardDataModel2"
                                [configModel]="chargesAmountCardConfigModel2"></app-charges-and-amount-card>
                              <app-charges-and-amount-card fxFlex="25" [dataModel]="chargesAmountCardDataModel3"
                                [configModel]="chargesAmountCardConfigModel3"></app-charges-and-amount-card>
                              <app-charges-and-amount-card fxFlex="16" [dataModel]="chargesAmountCardDataModel4"
                                [configModel]="chargesAmountCardConfigModel3"></app-charges-and-amount-card>
                            </div>
                          </div>
                        </div>
                        <div class="charges-list invoiced-charges mt-3">
                          <h3 class="heading">Invoiced Charges</h3>
                          <app-invoiced-charges-list [dataModel]="invoiceChargesListDataModel1"
                            [configModel]="invoiceChargesListConfigModel1"></app-invoiced-charges-list>
                        </div>
                        <div class="charges-list invoiced-charges mt-3">
                          <h3 class="heading">Potential Charges (Not Invoiced)</h3>
                          <app-invoiced-charges-list [dataModel]="invoiceChargesListDataModel2"
                            [configModel]="invoiceChargesListConfigModel2"></app-invoiced-charges-list>
                        </div>
                      </div>
                    </div>
                    <div fxFlex="20">
                      <div class="invoiced-charges-actions">
                        <button mat-raised-button color="primary" class="accept-charges-btn mb-3 w-100">Accept
                          Charges</button>
                        <button mat-raised-button color="primary" class="primary-button mb-3 w-100">Challenge
                          Penalty/Charge</button>
                        <button mat-raised-button color="primary" class="primary-button mb-3 w-100">Write-Off</button>
                        <button mat-raised-button color="primary" class="payment-button-3 mb-3 w-100">Record Negotiated
                          Charge</button>
                        <button mat-raised-button color="primary" class="payment-button-3 mb-3 w-100">Record
                          Payment</button>
                      </div>
                    </div>
                  </div>

                </div>
              </div>
            </div>
          </mat-tab>


          <mat-tab label="Map">
            <ng-template matTabContent>
              <app-permit-map-tab [dataModel]="permitMapDataModel" [configModel]="permitMapConfigModel">
                <ng-container class="elgin-map-view" *ngIf="viewElginMap">
                  <app-elginmap id="view-elgin-map" [dataModel]="viewElginMapDataModel"
                    [configModel]="viewElginMapConfigModel">
                  </app-elginmap>
                </ng-container>
              </app-permit-map-tab>
            </ng-template>
          </mat-tab>



          <mat-tab label="Change Request">
            <app-permit-change-request-tab [dataModel]="permitChangeReqDataModel"
              [configModel]="permitChangeReqConfigModel"></app-permit-change-request-tab>
          </mat-tab>
          <mat-tab label="Conditions">
            <app-permit-conditions-tab *ngIf="selectedTabIndex == 5" [dataModel]="permitConditionsDataModel"
              [configModel]="permitConditionsConfigModel"></app-permit-conditions-tab>
          </mat-tab>
          <mat-tab label="FPN's">
            <app-permit-fpn-tab [dataModel]="permitFPNDataModel" [configModel]="permitFPNConfigModel">
            </app-permit-fpn-tab>
          </mat-tab>
          <mat-tab label="Inspections">
            <app-permit-inspections-tab [dataModel]="permitInspectionListDataModel"
              [configModel]="permitInspectionListConfigModel"></app-permit-inspections-tab>
          </mat-tab>
          <mat-tab label="Images & Files">
            <app-permit-images-and-files-tab [dataModel]="permitImagesAndFilesDataModel"
              [configModel]="permitImagesAndFilesConfigModel"></app-permit-images-and-files-tab>
          </mat-tab>
          <mat-tab label="Reinstatement">
            <app-permit-reinstatement-tab [dataModel]="permitReinstatementDataModel"
              [configModel]="permitReinstatementConfigModel"></app-permit-reinstatement-tab>
          </mat-tab>
          <mat-tab label="Comments">
            <app-permit-comments-tab [dataModel]="permitCommentsDataModel" [configModel]="permitCommentsConfigModel">
            </app-permit-comments-tab>
          </mat-tab>
          <mat-tab label="Activity Log">
            <app-permit-activity-log-tab [dataModel]="permitActivityLogModel"
              [configModel]="permitActivityLogConfigModel"></app-permit-activity-log-tab>
          </mat-tab>







          <!--<mat-tab label="History">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="history-charges">
                                        <app-pcp-charge-history [dataModel]="pcpChargeHistoryDataModel" [configModel]="pcpChargeHistoryConfigModel"></app-pcp-charge-history>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </mat-tab> -->
        </mat-tab-group>
      </div>

    </div>
  </div>
</div>

<app-dialog [dialogModel]="dialogModelOpen" (onDialogClose)="onDialogModelOpenClose($event)">
  <ng-container class="dialog-content-slot">
    <div [ngSwitch]="pcpwWorkbenchDialogMode">
      <div *ngSwitchCase="pcpworkbenchDialogAcceptCharge">

        <app-pcp-accept-charge [dataModel]="pcpAcceptChargeDataModel" [configModel]="pcpAcceptChargeConfigModel">
        </app-pcp-accept-charge>
      </div>

      <div *ngSwitchCase="pcpworkbenchDialogChallengePenalty">

        <mat-tab-group>
          <mat-tab label="Details">
            <app-challenge-penalty-charge [dataModel]="pcpChallengePenaltyDataModel"
              [configModel]="pcpChallengePenaltyConfigModel"></app-challenge-penalty-charge>

          </mat-tab>
          <mat-tab label="Documents">

            <app-pcp-images-and-files [dataModel]="pcpImagesAndFilesDataModel"
              [configModel]="pcpImagesAndFilesConfigModel"></app-pcp-images-and-files>


          </mat-tab>
        </mat-tab-group>

      </div>

      <div *ngSwitchCase="pcpworkbenchDialogRecordNegotiated">

        <mat-tab-group>
          <mat-tab label="Details">
            <app-pcp-record-negotiated-cost [dataModel]="pcpRecordNegotiatedCostDataModel"
              [configModel]="pcpRecordNegotiatedCostConfigModel"></app-pcp-record-negotiated-cost>
          </mat-tab>
          <mat-tab label="Documents">

            <app-pcp-images-and-files [dataModel]="pcpImagesAndFilesDataModel"
              [configModel]="pcpImagesAndFilesConfigModel"></app-pcp-images-and-files>



          </mat-tab>
        </mat-tab-group>

      </div>


      <div *ngSwitchCase="pcpworkbenchDialogRecordInvoiceAmount">
        <app-pcp-record-invoice-amount [dataModel]="pcpRecordInvoiceAmountDataModel"
          [configModel]="pcpRecordInvoiceAmountConfigModel"></app-pcp-record-invoice-amount>
        <div fxLayout="row" fxLayoutAlign="end center">
          <button type="button" (click)="openAddRecordInvoiceCharge()" mat-raised-button color="primary"
            class="primary-button">
            + Add
          </button>
        </div>
        <app-data-table [dataModel]="dataTableDataModel" [configModel]="dataTableConfigModel"></app-data-table>
      </div>

      <div *ngSwitchCase="pcpworkbenchDialogAddTrafficManagementCost">
        <app-traffic-management-cost [dataModel]="trafficManagementCostModel"
          [configModel]="trafficManagementCostConfigModel"></app-traffic-management-cost>
        <div fxLayout="row" fxLayoutAlign="end center">
          <button (click)="openAddTrafficMangCost()" mat-raised-button color="primary" class="primary-button">
            + Add
          </button>
        </div>
        <app-traffic-mang-cost-list [dataModel]="trafficMangCostListModel"
          [configModel]="trafficMangCostListConfigModel"></app-traffic-mang-cost-list>
      </div>

      <div *ngSwitchCase="pcpworkbenchDialogRequestPaymentApproval">
        <app-pcp-request-payment-approval [dataModel]="pcpRequestPaymentApprovalDataModel"
          [configModel]="pcpRequestPaymentApprovalConfigModel"></app-pcp-request-payment-approval>
      </div>

      <div *ngSwitchCase="pcpworkbenchDialogWriteOff">


        <mat-tab-group>
          <mat-tab label="Details">
            <app-record-write-off [dataModel]="pcpRecordWriteOffDataModel" [configModel]="pcpRecordWriteOffConfigModel">
            </app-record-write-off>


          </mat-tab>
          <mat-tab label="Documents">

            <app-pcp-images-and-files [dataModel]="pcpImagesAndFilesDataModel"
              [configModel]="pcpImagesAndFilesConfigModel"></app-pcp-images-and-files>

          </mat-tab>
        </mat-tab-group>

      </div>


      <div *ngSwitchCase="pcpworkbenchDialogRecordPayment">
        <mat-tab-group>
          <mat-tab label="Details">
            <app-pcp-record-payment [dataModel]="pcpRecordPaymentDataModel" [configModel]="pcpRecordPaymentConfigModel">
            </app-pcp-record-payment>


          </mat-tab>
          <mat-tab label="Documents">

            <app-pcp-images-and-files [dataModel]="pcpImagesAndFilesDataModel"
              [configModel]="pcpImagesAndFilesConfigModel"></app-pcp-images-and-files>

          </mat-tab>
        </mat-tab-group>
      </div>

    </div>
    <hr>
    <div fxLayout="row" fxLayoutAlign="end center">
      <button mat-raised-button color="primary" (click)="onClickedSave()" class="primary-button">Save</button>
    </div>
  </ng-container>

</app-dialog>


<app-dialog [dialogModel]="dialogModelUpdate" (onDialogClose)="dialogModelUpdateclose($event)">
  <ng-container class="dialog-content-slot">
    <app-file-upload [dataModel]="fileUploadDataModel" [configModel]="fileUploadConfigModel">
    </app-file-upload>
  </ng-container>
</app-dialog>

<app-dialog [dialogModel]="dialogModelAdd">
  <ng-container class="dialog-content-slot">
    <div [ngSwitch]="pcpwWorkbenchDialogMode">
      <div *ngSwitchCase="addRecordInvoiceCharges">
        <app-add-record-invoice-charges [dataModel]="addRecordInvoiceChargesModel"
          [configModel]="addRecordInvoiceChargesConfigModel"></app-add-record-invoice-charges>
      </div>
      <div *ngSwitchCase="addTrafficManagementCost">
        <app-add-traffic-mang-cost [dataModel]="addTrafficMangCostModel" [configModel]="addTrafficMangCostConfigModel">
        </app-add-traffic-mang-cost>
      </div>
    </div>
  </ng-container>
</app-dialog>

<app-dialog [dialogModel]="dialogModel" (onDialogClose)="onAppDialogClose($event)">
  <ng-container class="dialog-content-slot">
    <div *ngIf="selectedTabIndex == 0 || selectedTabIndex == 4">
      <div [ngSwitch]="permitConfirmationDialogMode">
        <div *ngSwitchCase="permitCOnfirmDialogModeCancel">
          <app-cancel-permit-confirmation [dataModel]="permitCancelConfirmDataModel"
            [configModel]="permitCancelConfirmConfigModel"></app-cancel-permit-confirmation>
        </div>
        <div *ngSwitchCase="permitConfirmDialogModeProgressToPA" fxLayout="column" fxLayoutGap="40px">
          <div>Are you sure that you want to progress for PA ?</div>
          <div *ngIf="progressToPAWarningMessage" class="warning" fxLayout="row" fxLayoutGap="10px">
            <mat-icon>warning</mat-icon>
            <div>{{ progressToPAWarningMessage }}</div>
          </div>
          <form [formGroup]="progresstoPAFormGroup">
            <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="20px">

              <mat-form-field appearance="outline" fxFlex="48">
                <mat-label>Proposed Start Date</mat-label>
                <input matInput autocomplete="off" required [ngxMatDatetimePicker]="startDatePicker"
                  placeholder="Choose a date" [formControl]="progresstoPAFormGroup.controls.proposedStartDatePA"
                  (click)="startDatePicker.open()" />
                <mat-datepicker-toggle matSuffix [for]="startDatePicker"></mat-datepicker-toggle>
                <ngx-mat-datetime-picker #startDatePicker [showSeconds]="true" [stepHour]="1" [stepMinute]="1"
                  [stepSecond]="1" [enableMeridian]="false">
                </ngx-mat-datetime-picker>
                <mat-error>Field must be valid</mat-error>
              </mat-form-field>


              <mat-form-field appearance="outline" fxFlex="48">
                <mat-label>Proposed End Date</mat-label>
                <input matInput autocomplete="off" required [ngxMatDatetimePicker]="endDatePicker"
                  placeholder="Choose a date" [formControl]="
      progresstoPAFormGroup.controls.proposedEndDatePA
" (click)="endDatePicker.open()" />
                <mat-datepicker-toggle matSuffix [for]="endDatePicker"></mat-datepicker-toggle>
                <ngx-mat-datetime-picker #endDatePicker [showSeconds]="true" [stepHour]="1" [stepMinute]="1"
                  [stepSecond]="1" [enableMeridian]="false">
                </ngx-mat-datetime-picker>
                <mat-error>Field must be valid</mat-error>
              </mat-form-field>

            </div>
          </form>
          <div fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="15px">
            <button mat-stroked-button color="primary" class="primary-button-outline" (click)="onAppDialogClose('')">
              No
            </button>
            <button mat-raised-button class="primary-button" color="primary" (click)="onConfirmProgressToPA()">
              Yes
            </button>
          </div>
        </div>
        <div *ngSwitchCase="permitDialogModeCostSplit" fxLayout="column">
          <div class="cost-split" fxLayout="row" fxLayoutAlign="center center">
            <!-- <table fxFlex="90">
                          <tr>
                              <td class="cost-split-row-td-key">Permit Cost</td>
                              <td class="cost-split-row-td-value">
                                  {{ permitCostSplit.permit_cost | transformCurrency }}
                              </td>
                          </tr>
                          <tr>
                              <td class="cost-split-row-td-key">PAA Cost</td>
                              <td class="cost-split-row-td-value">
                                  {{ permitCostSplit.paa_cost | transformCurrency }}
                              </td>
                          </tr>
                          <tr>
                              <td class="cost-split-row-td-key">Variation Cost</td>
                              <td class="cost-split-row-td-value">
                                  {{ permitCostSplit.variation_cost | transformCurrency }}
                              </td>
                          </tr>
                          <tr>
                              <td class="cost-split-row-td-key">FPN Cost</td>
                              <td class="cost-split-row-td-value">
                                  {{ permitCostSplit.fpn_cost | transformCurrency }}
                              </td>
                          </tr>
                          <tr>
                              <td class="cost-split-row-td-key bg-total-row">Total Cost</td>
                              <td class="cost-split-row-td-value bg-total-row">
                                  {{ permitCostSplit.total_cost | transformCurrency }}
                              </td>
                          </tr>
                      </table> -->


            <table class="cost-split-table w-100">
              <tr>
                <th>
                  Charge
                </th>
                <th>
                  Estimated Cost
                </th>
                <th>
                  Discounted Cost
                </th>
              </tr>

              <tr *ngFor="let item of permitArrayItem">
                <td class="cost-split-row-td-key">{{item.key}}</td>
                <td class="cost-split-row-td-value">
                  {{ item.value1 }}
                </td>
                <td class="cost-split-row-td-value">
                  {{ item.value2 }}
                </td>
              </tr>

              <!-- <tr>
                            <td class="cost-split-row-td-key bg-total-row">Total Cost</td>
                            <td class="cost-split-row-td-value bg-total-row">
                                {{ permitCostSplit.total_cost | transformCurrency }}
                            </td>
                        </tr> -->
            </table>


          </div>
          <div fxLayout="row" fxLayoutAlign="center center">
            <button mat-raised-button class="primary-button" color="primary" (click)="onCostDetailsDialogClose()">
              OK
            </button>
          </div>
        </div>
        <div *ngSwitchCase="permitConfirmDialogModeChangeRequest">
          <div [ngSwitch]="createPermitStepNo" class="mat-typography permit-form">
            <!--   <div *ngSwitchCase="1">
        <app-create-permit-draw-map *ngIf="dialogModel.visible" [dataModel]="permitDrawMapDataModel"
          [configModel]="permitDrawMapConfigModel">
          <ng-container class="elgin-map-slot">
            <app-elginmap *ngIf="createPermitStepNo == 1" id="draw-map-elgin-map" [dataModel]="elginMapDataModel"
              [configModel]="elginMapConfigModel">
            </app-elginmap>
          </ng-container>
        </app-create-permit-draw-map>
      </div>
      <div *ngSwitchCase="2">
        <app-permit-conditions-tab [dataModel]="permitConditionsDataModel" [configModel]="permitConditionsConfigModel"
          *ngIf="dialogModel.visible">
        </app-permit-conditions-tab>
      </div>-->
            <div *ngSwitchCase="1">
              <hr />
              <app-raise-change-req-confirmation [dataModel]="raiseChangeReqConfirmationDataModel"
                [configModel]="raiseChangeReqConfirmationConfigModel"></app-raise-change-req-confirmation>
              <!-- <div class="confirm-msg-container">
                              <p>
                                  You are about to raise a promoter-initiated change request. Note that change requests are only applicable under the following conditions:
                              </p>
                              <ol>
                                  <li>
                                      The status of the original permit is “Granted” or “Submitted” (and awaiting assessment)
                                  </li>
                                  <li>The works in in progress and requires an extension</li>
                                  <li>
                                      There is no open change request being assessed by the HA for this permit.
                                  </li>
                              </ol>
                              <p>
                                  Note that there is a
                                  <span class="charge-tag">{{
                  permitProposedVariationCost | transformCurrency
                }}</span>
                charge for raising a change request.
              </p>
              <br />
              <p>
                <strong
                  >Do you want to continue with raising a change
                  request?</strong
                >
              </p>
            </div> -->
            </div>

            <div *ngSwitchCase="2">
              <div *ngIf="!isviewchangereqmode">
                <app-permit-map-designation-tab [dataModel]="permitMapDesignationModel"
                  [configModel]="permitMapDesignationConfigModel">
                  <ng-container class="elgin-map-view">
                    <app-elginmap id="view-elgin-map" [dataModel]="viewElginMapDataModel"
                      [configModel]="viewElginMapConfigModel">
                    </app-elginmap>
                  </ng-container>
                </app-permit-map-designation-tab>
              </div>

              <div *ngIf="isviewchangereqmode">
                <app-permit-map-tab [dataModel]="permitMapDataModel" [configModel]="permitMapConfigModel">
                  <ng-container class="elgin-map-view">
                    <app-elginmap id="view-elgin-map" [dataModel]="viewElginMapDataModel"
                      [configModel]="viewElginMapConfigModel">
                    </app-elginmap>
                  </ng-container>
                </app-permit-map-tab>
              </div>
            </div>

            <div *ngSwitchCase="3">
              <app-create-permit-form [dataModel]="createPermitFormDataModel"
                [configModel]="createPermitFormConfigModel">
                <ng-container class="elgin-map-view-slot">
                  <app-elginmap id="create-permit-elgin-map" [dataModel]="elginMapDataModel"
                    [configModel]="elginMapConfigModel">
                  </app-elginmap>
                </ng-container>
              </app-create-permit-form>
            </div>

            <div *ngSwitchCase="4">
              <app-permit-conditions-tab [dataModel]="permitConditionsDataModel"
                [configModel]="permitConditionsConfigModel" *ngIf="dialogModel.visible">
              </app-permit-conditions-tab>
            </div>

            <div *ngSwitchCase="5">
              <app-data-diff-a3 [dataModel]="dataDiffA3DataModel" [configModel]="dataDiffA3ConfigModel">
              </app-data-diff-a3>
            </div>

            <div *ngSwitchDefault>Something went wrong..!!</div>
          </div>
          <hr />
          <div>
            <div [ngSwitch]="createPermitStepNo">
              <div *ngSwitchCase="1" fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="15px">
                <button mat-stroked-button color="primary" class="primary-button-outline"
                  (click)="onAppDialogClose('')">
                  No
                </button>
                <button mat-raised-button class="primary-button" color="primary" (click)="onChangeRequest()">
                  Yes
                </button>
              </div>

              <div *ngSwitchCase="2" fxLayoutGap="10px" fxLayout="row" fxLayoutAlign="end center">
                <!-- <button mat-stroked-button color="primary" class="primary-button-outline"
            (click)="backButtonConditionClick()">Go Back</button> -->
                <button *ngIf="!isviewchangereqmode" mat-raised-button color="primary" class="primary-button"
                  (click)="nextButtonDrawMapClick()">
                  Next
                </button>
                <button *ngIf="isviewchangereqmode" mat-raised-button color="primary" class="primary-button"
                  (click)="onChangeRequest()">
                  Next
                </button>
              </div>

              <div *ngSwitchCase="3" fxLayoutGap="10px" fxLayout="row" fxLayoutAlign="space-between center">
                <button mat-stroked-button color="primary" class="primary-button-outline" (click)="backStep()">
                  Go Back
                </button>
                <button mat-raised-button color="primary" class="primary-button" (click)="nextButtonPermitFormClick()">
                  Next
                </button>
              </div>

              <div *ngSwitchCase="4" fxLayout="row" fxLayoutAlign="space-between center">
                <button mat-stroked-button color="primary" class="primary-button-outline"
                  (click)="backButtonPermitFormClick()">
                  Go Back
                </button>
                <div fxLayoutGap="10px">
                  <button *ngIf="
                    alterationApplicationId == null && !isviewchangereqmode
                  " mat-raised-button class="draft-button primary-button mb-2" color="primary"
                    (click)="nextButtonConditionClick('save-as-draft')">
                    Save As Draft
                  </button>
                  <button *ngIf="!isviewchangereqmode" mat-raised-button class="primary-button mb-2" color="primary"
                    (click)="nextButtonConditionClick('submit-change-request')">
                    Review & Submit Change Request
                  </button>
                  <button *ngIf="isviewchangereqmode" mat-raised-button class="primary-button mb-2" color="primary"
                    (click)="appDialogClose(null)">
                    OK
                  </button>
                </div>
              </div>

              <div *ngSwitchCase="5" fxLayout="row" fxLayoutAlign="space-between center">
                <div>
                  <!-- <button mat-stroked-button color="primary" class="primary-button-outline" (click)="backStep()">
                  Go Back
                </button> -->
                </div>
                <div fxLayout="row" fxLayoutAlign="end center">
                  <p style="margin-right: 25px">
                    Are you sure you want to confirm?
                  </p>

                  <button mat-raised-button class="green-button mb-2" color="primary"
                    (click)="onConfirmChangeRequest()">
                    Confirm
                  </button>
                </div>
              </div>
              <div *ngSwitchDefault></div>
            </div>
          </div>
        </div>
        <div *ngSwitchCase="permitConfirmDialogModeNewPermit">
          <div [ngSwitch]="createPermitStepNo" class="mat-typography permit-form">
            <div *ngSwitchCase="1">
              <app-create-permit-form [dataModel]="createPermitFormDataModel"
                [configModel]="createPermitFormConfigModel">
                <ng-container class="elgin-map-view-slot">
                  <app-elginmap id="create-permit-elgin-map" [dataModel]="elginMapDataModel"
                    [configModel]="elginMapConfigModel">
                  </app-elginmap>
                </ng-container>
              </app-create-permit-form>
            </div>

            <div *ngSwitchCase="2">
              <app-permit-conditions-tab [dataModel]="permitConditionsDataModel"
                [configModel]="permitConditionsConfigModel" *ngIf="dialogModel.visible">
              </app-permit-conditions-tab>
            </div>

            <div *ngSwitchCase="3">
              <app-create-permit-summary [dataModel]="summaryDataModel" [configModel]="summaryConfigModel"
                *ngIf="dialogModel.visible"></app-create-permit-summary>
            </div>

            <div *ngSwitchCase="4">
              <app-create-permit-confirmation [dataModel]="permitConfirmationDataModel"
                [configModel]="permitConfirmationConfigModel" *ngIf="dialogModel.visible">
              </app-create-permit-confirmation>
            </div>

            <div *ngSwitchDefault></div>
          </div>
          <hr />
          <div>
            <div [ngSwitch]="createPermitStepNo">
              <div *ngSwitchCase="1" fxLayoutGap="10px" fxLayout="row" fxLayoutAlign="end center">
                <button mat-raised-button color="primary" class="primary-button"
                  (click)="nextButtonNewPermitFormClick()">
                  Next
                </button>
              </div>

              <div *ngSwitchCase="2" fxLayout="row" fxLayoutAlign="space-between center">
                <button mat-stroked-button color="primary" class="primary-button-outline"
                  (click)="backButtonNewPermitConditionClick()">
                  Go Back
                </button>
                <div fxLayoutGap="10px">
                  <button mat-raised-button class="draft-button primary-button mb-2" color="primary"
                    (click)="newPermitSaveAsDraftClick()">
                    Save As Draft
                  </button>
                  <button mat-raised-button class="primary-button mb-2" color="primary"
                    (click)="newPermitSubmitClick()">
                    Submit New Phase
                  </button>
                </div>
              </div>

              <div *ngSwitchCase="3" fxLayout="row" fxLayoutAlign="space-between center">
                <button mat-stroked-button color="primary" class="primary-button-outline"
                  (click)="backButtonNewPermitConfirmSubmitClick()">
                  Go Back
                </button>
                <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="start center">
                  <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="start center">
                    <p style="margin-right: 25px">
                      Are you sure you want to confirm?
                    </p>
                    <button mat-raised-button class="green-button primary-button mb-2" color="primary"
                      (click)="newPermitConfirm()">
                      Confirm
                    </button>
                  </div>
                  <button mat-raised-button class="draft-button primary-button mb-2" color="primary"
                    (click)="submissionConfirmSaveNewPermitAsDraft()">
                    Save As Draft
                  </button>
                </div>
              </div>
              <div *ngSwitchCase="4" fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="15px">
                <button mat-raised-button class="primary-button mb-2" (click)="onNewPermitViewClick()" color="primary">
                  View Permit
                </button>
                <button mat-raised-button class="primary-button mb-2" color="primary"
                  (click)="onNewPermitViewPermitListClick()">
                  View List
                </button>
              </div>

              <div *ngSwitchDefault></div>
            </div>
          </div>
        </div>
        <div *ngSwitchCase="permitConfirmDialogModeWorkExtension">
          <div class="wrk-extension-form">
            <form [formGroup]="workExtensionFormGroup">
              <mat-form-field appearance="outline" fxFlex="100">
                <mat-label>Proposed End Date</mat-label>
                <input matInput autocomplete="off" required [ngxMatDatetimePicker]="endDatePicker"
                  placeholder="Choose a date" [formControl]="
                  workExtensionFormGroup.controls.proposedEndDate
                " (click)="endDatePicker.open()" />
                <mat-datepicker-toggle matSuffix [for]="endDatePicker"></mat-datepicker-toggle>
                <ngx-mat-datetime-picker #endDatePicker [showSeconds]="true" [stepHour]="1" [stepMinute]="1"
                  [stepSecond]="1" [enableMeridian]="false">
                </ngx-mat-datetime-picker>
                <mat-error>Field must be valid</mat-error>
              </mat-form-field>
            </form>
          </div>
          <hr />
          <div>
            <div fxLayoutGap="10px" fxLayout="row" fxLayoutAlign="end center">
              <button mat-raised-button color="primary" class="primary-button" (click)="onSubmitWorkExtensionClick()">
                Submit
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <app-file-upload *ngIf="selectedTabIndex == 8" [dataModel]="fileUploadDataModel"
      [configModel]="fileUploadConfigModel">
    </app-file-upload>
    <div *ngIf="selectedTabIndex == 9">
      <div [ngSwitch]="reinstatementDialogMode">
        <div *ngSwitchCase="reinstatementDialogModeAddReinstatement">
          <div [ngSwitch]="createReinstatementStepNo" class="mat-typography permit-form">
            <div *ngSwitchCase="1">
              <app-create-permit-draw-map *ngIf="dialogModel.visible" [dataModel]="permitDrawMapDataModel"
                [configModel]="permitDrawMapConfigModel">
                <ng-container class="elgin-map-slot">
                  <app-elginmap *ngIf="createReinstatementStepNo == 1" id="draw-map-elgin-map"
                    [dataModel]="elginMapDataModel" [configModel]="elginMapConfigModel">
                  </app-elginmap>
                </ng-container>
              </app-create-permit-draw-map>
            </div>

            <div *ngSwitchCase="2">
              <app-create-reinstatement-form *ngIf="dialogModel.visible" [dataModel]="createReinstatementFormDataModel"
                [configModel]="createReinstatementFormConfigModel">
              </app-create-reinstatement-form>
            </div>

            <div *ngSwitchCase="3">
              <app-reinstatement-images-and-files *ngIf="dialogModel.visible"
                [dataModel]="reinstatementImagesAndFilesDataModel"
                [configModel]="reinstatementImagesAndFilesConfigModel"></app-reinstatement-images-and-files>
            </div>

            <div *ngSwitchCase="4">
              <app-create-reinstatement-summary *ngIf="dialogModel.visible"
                [dataModel]="createReinstatementSummuryDataModel" [configModel]="createReinstatementSummuryConfigModel">
              </app-create-reinstatement-summary>
            </div>

            <div *ngSwitchDefault>Something went wrong..!!</div>
          </div>
          <hr />
          <div>
            <div [ngSwitch]="createReinstatementStepNo">
              <div *ngSwitchCase="1" fxLayoutGap="10px" fxLayout="row" fxLayoutAlign="end center">
                <button mat-raised-button color="primary" class="primary-button"
                  (click)="nextButtonReinstatementDrawMapClick()">
                  Next
                </button>
              </div>

              <div *ngSwitchCase="2" fxLayout="row" fxLayoutAlign="space-between center">
                <button mat-stroked-button color="primary" class="primary-button-outline"
                  (click)="backButtonReinstatementFormClick()">
                  Go Back
                </button>
                <div fxLayoutGap="10px">
                  <button mat-raised-button class="draft-button primary-button mb-2" color="primary"
                    (click)="saveReinstatementAsDraft(saveAsDraftAndClose)">
                    Save As Draft
                  </button>
                  <button mat-raised-button color="primary" class="primary-button"
                    (click)="nextButtonReinstatementFormClick()">
                    Next
                  </button>
                </div>
              </div>

              <div *ngSwitchCase="3" fxLayout="row" fxLayoutAlign="space-between center">
                <button mat-stroked-button color="primary" class="primary-button-outline"
                  (click)="backButtonReinstatementUploadClick()">
                  Go Back
                </button>
                <div fxLayoutGap="10px">
                  <button mat-raised-button class="primary-button mb-2" color="primary"
                    (click)="nextButtonReinstatementUploadClick()">
                    Review Changes
                  </button>
                </div>
              </div>

              <div *ngSwitchCase="4" fxLayout="row" fxLayoutAlign="space-between center">
                <button mat-stroked-button color="primary" class="primary-button-outline"
                  (click)="backButtonReinstatementSummaryClick()">
                  Go Back
                </button>
                <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="start center">
                  <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="start center">
                    <p style="margin-right: 25px">
                      Are you sure you want to confirm?
                    </p>
                    <button mat-raised-button class="green-button primary-button mb-2" color="primary"
                      (click)="reinstatementSubmission()">
                      Confirm
                    </button>
                  </div>
                  <button mat-raised-button class="draft-button primary-button mb-2" color="primary"
                    (click)="closeReinstatementDraft()">
                    Save As Draft
                  </button>
                </div>
              </div>
              <div *ngSwitchDefault></div>
            </div>
          </div>
        </div>
        <div *ngSwitchCase="reinstatementDialogModeViewReinstatement">

          <mat-tab-group mat-stretch-tabs>
            <mat-tab label="Details">

              <app-site-details *ngIf="dialogModel.visible" [dataModel]="siteDetailsDataModel"
                [configModel]="siteDetailsConfigModel">
                <ng-container class="elgin-map-view" *ngIf="viewElginMap">
                  <app-elginmap id="view-elgin-map" [dataModel]="viewElginMapReinstatementDataModel"
                    [configModel]="viewElginReinstatementConfigModel">
                  </app-elginmap>
                </ng-container>
              </app-site-details>


            </mat-tab>

            <mat-tab label="Attachments">
              <app-reinstatement-images-and-files *ngIf="dialogModel.visible"
                [dataModel]="reinstatementImagesAndFilesDataModel"
                [configModel]="reinstatementImagesAndFilesConfigModel"></app-reinstatement-images-and-files>

            </mat-tab>
          </mat-tab-group>


        </div>
      </div>
    </div>
    <app-add-comment *ngIf="selectedTabIndex == 10 && !isViewCommentTrue" [dataModel]="permitAddCommentDataModel"
      [configModel]="permitAddCommentConfigModel"></app-add-comment>

    <div *ngIf="selectedTabIndex == 4">
      <div [ngSwitch]="changeRequestDialogMode" class="mat-typography permit-form">
        <div *ngSwitchCase="changeRequestDialogModDiff">
          <mat-card class="mt-4">
            <div class="row">
              <div class="col-12">


                <!-- <table class="table borderless-table table-borderless">
                                  <tr>
                                      <td class="w-75"> Permit Alteration Reference Number <span class=" pl-4 titletext"> {{permit_alteration_ref_no | uppercase }}</span></td>

                                      <td> Assessment Status <span class="titletext pl-4"> {{assessment_status | titlecase }}</span> </td>
                                  </tr>



                                  <tr>
                                      <td colspan="2"> Assessment Comments <span class="pl-4 commenttext">{{assessment_comments | titlecase }}</span></td>

                                  </tr>
                              </table> -->


                <div class="row">
                  <div class="col-6">
                    <div class="info-label "> Permit Alteration Reference Number</div>
                    <div class="titletext">{{permit_alteration_ref_no | uppercase }}</div>
                  </div>
                  <div class="col-6">
                    <div class="info-label "> Assessment Status</div>
                    <div class="titletext">{{assessment_status | titlecase }}</div>
                  </div>
                  <div class="col-12 mt-5">
                    <div class="info-label "> Assessment Comments</div>
                    <div class="titletext">{{assessment_comments | titlecase }}</div>
                  </div>
                </div>


              </div>

            </div>

          </mat-card>

          <app-data-diff-a3 [dataModel]="dataDiffA3DataModel" [configModel]="dataDiffA3ConfigModel"></app-data-diff-a3>
        </div>
        <!-- <div *ngSwitchCase="changeRequestDialogModeView">
              <app-create-permit-form [dataModel]="createPermitFormDataModel" [configModel]="createPermitFormConfigModel">
              <ng-container class="elgin-map-view-slot">
                <app-elginmap id="create-permit-elgin-map" [dataModel]="elginMapDataModel"  [configModel]="elginMapConfigModel">
                </app-elginmap>
              </ng-container>
            </app-create-permit-form>
          </div>

          <div *ngSwitchCase="changeRequestDialogModEdit">
              <app-create-permit-form [dataModel]="createPermitFormDataModel" [configModel]="createPermitFormConfigModel">
                  <ng-container class="elgin-map-view-slot">
                    <app-elginmap id="create-permit-elgin-map" [dataModel]="elginMapDataModel"  [configModel]="elginMapConfigModel">
                    </app-elginmap>
                  </ng-container>
                </app-create-permit-form>
          </div> -->
      </div>
    </div>

    <app-view-permit-fpn *ngIf="selectedTabIndex == 6 && dialogModel.visible" [dataModel]="viewPermitFpnDataModel"
      [configModel]="viewPermitFpnConfigModel">
    </app-view-permit-fpn>
    <app-view-permit-inspection *ngIf="selectedTabIndex == 7 && dialogModel.visible"
      [dataModel]="viewPermitInspectionDataModel" [configModel]="viewPermitInspectionConfigModel">
    </app-view-permit-inspection>
    <div *ngIf="selectedTabIndex == 7 && dialogModel.visible">
      <div fxLayout="row" fxLayoutAlign="end center">
        <button mat-raised-button class="primary-button mb-2" (click)="updateInspection()"
          color="primary">Update</button>
      </div>
    </div>
    <app-view-permit-comments *ngIf="isViewCommentTrue && dialogModel.visible" [dataModel]="viewPermitCommentsDataModel"
      [configModel]="viewPermitCommentConfigModel">
    </app-view-permit-comments>
  </ng-container>
</app-dialog>

<p-dialog [(visible)]="display" class="errormodal" [modal]="true" [responsive]="true" [style]="{
  width: '800px',
  minWidth: '700px',
  'text-align': 'center',
  'font-size': '15px'
}" [minY]="100" [maximizable]="true" [baseZIndex]="10000">
  <p-header class="mat-error">
    <mat-icon class="align-middle">error</mat-icon> Error
  </p-header>

  <div class="jumbotron mb-0">
    <label class="errorlabel">{{ errorMsg }}</label>
  </div>

  <button class="btn btn-lg btn-primary errorbtn float-right" (click)="display = false">
    OK
  </button>
</p-dialog>

<app-dialog [dialogModel]="dialogConfirm">
  <ng-container class="dialog-content-slot" *ngIf="!isworkextensionconfirm">
    <p class="py-3">
      Are you sure you want to delete change request
      <b>{{ CRReferenceNumber }}</b> ?
    </p>
    <div class="float-right">
      <button (click)="confirmDelete()" mat-raised-button class="primary-button" color="warn">
        Confirm
      </button>
    </div>
  </ng-container>

  <ng-container class="dialog-content-slot" *ngIf="isworkextensionconfirm">
    <p class="py-3">
      You are about to submit a work extension request to Street Manager. Note that this is a chargeable activity. Do
      you want to proceed?
    </p>
    <div class="float-right">
      <button (click)="confirmsubmitworkextension('yes')" mat-raised-button class="primary-button btn-primary mr-2"
        color="primary">
        Yes
      </button>
      <button (click)="confirmsubmitworkextension('no')" mat-raised-button class="primary-button btn-secondary">
        No
      </button>
    </div>
  </ng-container>
</app-dialog>

<!-- <app-dialog [dialogModel]="dialogConfirmWorkExtension">
<ng-container class="dialog-content-slot">
    <p class="py-3">You are about to submit a work extension request
      to Street Manager. Note that this is a chargeable activity. Do you want to
     proceed? (Y/N)</p>
    <div class="float-right">
    <button (click)="confirmsubmitworkextension('yes')" mat-raised-button class="primary-button btn-primary mr-2" color="primary">Yes</button>
    <button (click)="confirmsubmitworkextension('no')" mat-raised-button class="primary-button btn-secondary" >No</button>
</div>
</ng-container>
</app-dialog> -->



<app-dialog [dialogModel]="dialogDeleteReinstatement">
  <ng-container class="dialog-content-slot">
    <p class="py-3">
      Are you sure you want to delete reinstatement for site
      <b>{{SiteIdToBeDelete}}</b> ?
    </p>
    <div class="float-right">
      <button (click)="confirmDeleteReinstatement()" mat-raised-button class="primary-button" color="warn">
        Confirm
      </button>
    </div>
  </ng-container>
</app-dialog>


<app-dialog [dialogModel]="dialogReinstatementUpload">
  <ng-container class="dialog-content-slot">
    <app-file-upload [dataModel]="fileUploadDataModel1" [configModel]="fileUploadConfigModel1">
    </app-file-upload>
  </ng-container>
</app-dialog>


<app-dialog [dialogModel]="dialogOnRegister">
  <ng-container class="dialog-content-slot">
    <p class="py-3">
      You are being redirected to the Reinstatement Page where you can register site
    </p>
    <div class="float-right">
      <div fxLayout="row" fxLayoutAlign="space-between stretch" fxLayoutGap="20px">
        <button mat-raised-button class="primary-button-outline mb-2" color="primary" (click)="closeDialogOnRegister()">
          Cancel
        </button>
        <button mat-raised-button class="primary-button mb-2" color="primary" (click)="navigateToReinstatement()">
          Yes
        </button>
      </div>
    </div>
  </ng-container>
</app-dialog>
